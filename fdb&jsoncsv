"""
–¥–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–∑ —Å–µ–±—è 2 —Ñ—É–Ω–∫—Ü–∏–∏:
`fake_db()` - —Å–æ–∑–¥–∞—ë—Ç –ª–∏–ø–æ–≤—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–æ–≤–µ—Ä–æ–∫
`json2csv()` - –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä json –≤ csv

–∞–≤—Ç–æ—Ä: –í–∞–ª–µ—Ä–∞ –¢—É–≥–∞—Ä–∏–Ω
–¥–∞—Ç–∞: 14.02.2024
–ø–æ—Ç—Ä–∞—á–µ–Ω–æ: ~5—á., —Å —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ–ºüôÇ 
"""

import json
from faker import Faker
import os

def fake_db(amount: int=100):
    fake = Faker() # –¥–µ—Ñ–æ–ª—Ç: —Å–æ–∑–¥–∞—é —ç–∫–∑–µ–º–ø–ª—è—Ä —Ñ–µ–π–∫–µ—Ä–∞
    people_data = [] # –∏ —Ç—É—Ç –∂–µ —Å–æ–∑–¥–∞–ª –æ–±—ä–µ–∫—Ç, –µ—Å–ª–∏ –±—ã —ç—Ç–æ –±—ã–ª–∞ —Ñ—É–Ω–∫—Ü–∏—è, —Ç–æ –æ–Ω –±—ã–ª –±—ã –≤—Ä–µ–º–µ–Ω–Ω—ã–º, –ø–æ—ç—Ç–æ–º—É –Ω–µ —Å—Ç—Ä–∞—à–Ω–æ 

    for i in range(amount): # –ø–∏–∑–¥–æ–ø–ª—è—Å–∫–∞, –≥–µ–Ω–µ—Ä–∏—Ä—É—é —Ñ–µ–π–∫–æ–≤—ã—Ö –ª—é–¥–∏—à–µ–∫
        person = {
            "id": i + 1,
            "name": fake.name(),
            "country": fake.country(),
            "email": fake.email(),
            "phone_number": fake.phone_number(),
        }
        people_data.append(person) # –¥–æ–±–∞–≤–∏–ª —Å–ª–æ–≤–∞—Ä—å –ª—é–¥–∏—à–∫–∞ –≤ —Å–ø–∏—Å–æ–∫

    # –∑–∞–ø–∏—Å—ã–≤–∞—é —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π –≤ –¥–∂–µ–π—Å–æ–Ω(—Å—Ç—ç—Ç—Ö–µ–º? –Ω–µ—Ç –±–ª—è—Ç—å –¥–∂–∏–ª–µ–Ω–≥—Ö–æ–ª–ª)
    filename = "dbinput.json"
    file_path = os.path.join(os.getcwd(), filename) # —Ä–æ—Ñ–ª, –ø—Ä–æ—Å—Ç–æ —Ö–æ—Ç–µ–ª —É–∑–Ω–∞—Ç—å –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç
    with open(filename, 'w') as json_file:
        json.dump(people_data, json_file, indent=4)

    
    
    return print(f'\n–ø—É—Ç—å –∫ —Ñ–µ–π–∫–æ–≤–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö: \n{file_path}\n')


def json2csv(filename="dbinput.json"):
    try:
        with open(filename, 'r') as file:
            data = json.loads(file.read())

        output = ','.join(data[0].keys())
        for obj in data:
            output += f'\n{','.join(map(str, obj.values()))}'



        with open("output.csv", 'w') as f:
            f.write(output)
    except Exception as ex:
        print(f'\n{ex}\n')

fake_db()
json2csv()